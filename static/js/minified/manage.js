$(document).ready(function(){function e(e){var t,i={id:e.data("id").toString(),type:(t=document.location.href,t.match("/approve").length>0?"suggestion":t.match("/manage").length>0?"conference":void 0)},n=new FormData;n.append("data",JSON.stringify(i)),$.ajax({type:"POST",url:"/purge",contentType:!1,data:n,processData:!1,success:function(t){"OK"===t&&e.fadeOut().remove()},error:function(e){console.log("some error",e)}})}$(".remove").each(function(){$(this).on("click",function(){$($(this).parents()[1]).css("background-image","url(./img/placeholder.png)")})}),$(".upload").each(function(){$(this).on("click",function(){$($($(this).parents()[2]).find(".fileinput")[0]).click()})}),$(".item.big.admin").each(function(){var e=$(this).find("input");for(item in e)if(item>=1){var t=$(e[item]);t.val(t.attr("placeholder")),t.attr("placeholder","You emptied this!")}var i=$($(this).find("textarea")[0]);i.val(i.attr("placeholder")),i.attr("placeholder","You emptied this!")}),$(".fileinput").each(function(){$(this).change(function(){var e=this.files[0],t=new FileReader,i=$($($(this).parents()[0]).find(".img")[0]);t.onloadend=function(){i.css("background-image",'url("'+t.result+'")')},e&&t.readAsDataURL(e)})}),$(".reject").each(function(){$(this).on("click",function(){e($($(this).parents()[1]))})}),$(".approve").each(function(){$(this).on("click",function(){!function(t){var i=t.find("input"),n=i[1].value,a=i[2].value,o=i[3].value.split(", ")[0],c=i[3].value.split(", ")[1],r=i[4].value,s=t.find(".fileinput")[0].files[0],l=t.find("textarea")[0].value;if(s)var u=s.name;else'url("http://localhost/img/placeholder.png")'!=$(t.find(".img")[0]).css("background-image")&&(u=$(t.find(".img")[0]).css("background-image").split("/pending/")[1].replace('")',""));var p=new FormData,d={title:n,date:a,country:c,city:o,description:l,website:r,image:u,approve:!0};p.append("data",JSON.stringify(d)),p.append("file",s),$.ajax({type:"POST",url:"/submit",contentType:!1,data:p,processData:!1,success:function(i){"OK"===i&&e(t)},error:function(e){console.log("some error",e)}})}($($(this).parents()[1]))})})});
